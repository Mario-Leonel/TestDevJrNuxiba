<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba 2 Consumo de API</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">

</head>
<body>
    <h1>Consumiendo Api de jsonplaceholder</h1>
   <!--- <section>
        <h2 class="title">listar usuarios</h2>
        <form action="" class="crudForm">
            <input type="text" class="titulo form-control">
            <input type="checkbox" name="completada" id="completada" class="completada form-control">
            <button class="btn btn-success"></button>
        </form>
    </section>-->
    <section class="usuarios" id="usuarios">
        <h2 class="todos">Todos los usuarios</h2>
        <table class="table">
            <thead>
                <tr>
                <th>nombre</th>
                <th></th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
   
    </section>
    <section class="detalles" id="detalle">
        <h2 >Detalles de usuario</h2>
        <article>
            <h3 class="name"></h3>
            <h3 class="usernamer"></h3>
            <h3 class="email"></h3>
            <p>
                <a  href="#posts" class="btn btn-success posts" id=""> posts</a>
                <a  href="#todos" class="btn btn-primary todos" id=""> todos</a>

            </p>
                    </article>
   
   
    </section>
    <template  id="verUsuarios">
        <tr>
            <td class="nombre"></td>
            <td class="opciones">
                <a  href="#detalle" class="btn btn-secondary ver" id=""> ver</a>
            </td>
        </tr>
        </template>
    <template  id="templDetalles">
        <h1 class="nombre"></h1>
    </template>

</body>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js" integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0" crossorigin="anonymous"></script>

<script>
    const d=document,
    $table=d.querySelector('table'),
    $deta=d.querySelector('.detalles'),
    $ver=d.querySelector('.ver'),
    $title=d.querySelector('title'),
    $template=d.getElementById('verUsuarios').content,
    $templDe=d.getElementById('templDetalles').content,
    $fragment=d.createDocumentFragment();

    fetch('https://jsonplaceholder.typicode.com/users')
        .then((response) => response.json())
        .then((json) => {
            json.forEach(element => {
                $template.querySelector(".nombre").textContent= element.name;
                $template.querySelector(".ver").setAttribute('id', element.id);

                let $clone =d.importNode($template,true);
                $fragment.appendChild($clone);

            });
            $table.querySelector("tbody").appendChild($fragment);        
        });

        /////////////
        d.addEventListener('click',async e=>{
           
           if(e.target.matches(".ver")){
               
               fetch('https://jsonplaceholder.typicode.com/users/'+e.target.id)
               .then((response) => response.json())
               .then((json) =>{
                  d.querySelector(".name").textContent= json.address.city;
                  d.querySelector(".posts").setAttribute('id', json.id);

            
                  
               });
           }
       });
       /////////////////////////
        d.addEventListener('click',async e=>{
           
            if(e.target.matches(".posts")){
                
                fetch('https://jsonplaceholder.typicode.com/users/'+e.target.id+'/posts')
                .then((response) => response.json())
                .then((json) =>console.log(json));
            }
        });
  
</script>
</html>